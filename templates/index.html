<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="AI-powered car price prediction tool with machine learning"
    />
    <title>Car Price Predictor - AI-Powered Valuation Tool</title>

    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@500;700&display=swap"
      rel="stylesheet"
    />

    <style>
      :root {
        --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        --success-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        --neon-blue: #00d4ff;
        --neon-purple: #b794f6;
        --neon-pink: #ff6b9d;
        --dark-bg: #0a0a0a;
        --card-bg: rgba(15, 15, 25, 0.95);
        --glass-bg: rgba(255, 255, 255, 0.03);
        --border-color: rgba(255, 255, 255, 0.08);
        --text-primary: #ffffff;
        --text-secondary: #e2e8f0;
        --text-muted: #94a3b8;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Poppins", sans-serif;
        background: var(--dark-bg);
        color: var(--text-primary);
        min-height: 100vh;
        overflow-x: hidden;
      }

      /* Simplified background - no heavy animations */
      .main-container {
        min-height: 100vh;
        background: radial-gradient(
            circle at 20% 20%,
            rgba(0, 212, 255, 0.08) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 80% 80%,
            rgba(183, 148, 246, 0.08) 0%,
            transparent 50%
          ),
          linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
        padding: 2rem 0;
        position: relative;
      }

      /* Subtle grid overlay - reduced opacity */
      .grid-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image: linear-gradient(
            rgba(0, 212, 255, 0.02) 1px,
            transparent 1px
          ),
          linear-gradient(90deg, rgba(0, 212, 255, 0.02) 1px, transparent 1px);
        background-size: 60px 60px;
        pointer-events: none;
        z-index: -1;
        opacity: 0.3;
      }

      /* Simplified car background - fewer elements */
      .car-background {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: -2;
        opacity: 0.02;
      }

      .car-silhouette {
        position: absolute;
        font-size: 2rem;
        color: var(--neon-blue);
        animation: floatCars 30s infinite linear;
      }

      .car-silhouette:nth-child(1) {
        top: 20%;
        left: -10%;
        animation-delay: 0s;
      }
      .car-silhouette:nth-child(2) {
        top: 60%;
        left: -10%;
        animation-delay: 15s;
      }

      @keyframes floatCars {
        0% {
          transform: translateX(-100px);
          opacity: 0;
        }
        10%,
        90% {
          opacity: 0.05;
        }
        100% {
          transform: translateX(calc(100vw + 100px));
          opacity: 0;
        }
      }

      /* Hero section - simplified animations */
      .hero-section {
        text-align: center;
        padding: 3rem 0;
        position: relative;
        z-index: 10;
      }

      .hero-container {
        opacity: 0;
        transform: translateY(-30px);
        animation: heroReveal 1.5s ease-out forwards;
      }

      @keyframes heroReveal {
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .hero-title {
        font-size: 4rem;
        font-weight: 800;
        background: linear-gradient(
          135deg,
          #00d4ff 0%,
          #b794f6 50%,
          #ff6b9d 100%
        );
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        margin-bottom: 1rem;
        line-height: 1.1;
      }

      .hero-title i {
        margin-right: 1rem;
        animation: carBounce 4s ease-in-out infinite;
      }

      @keyframes carBounce {
        0%,
        100% {
          transform: translateY(0) rotate(-5deg);
        }
        50% {
          transform: translateY(-8px) rotate(5deg);
        }
      }

      .hero-subtitle {
        font-size: 1.3rem;
        color: var(--text-secondary);
        max-width: 600px;
        margin: 0 auto 2rem;
        opacity: 0;
        animation: subtitleFade 1s ease-out 0.5s forwards;
      }

      @keyframes subtitleFade {
        to {
          opacity: 1;
        }
      }

      /* Simplified status indicator */
      .status-indicator {
        display: inline-flex;
        align-items: center;
        gap: 0.8rem;
        background: var(--glass-bg);
        backdrop-filter: blur(15px);
        border: 1px solid var(--border-color);
        padding: 0.8rem 1.5rem;
        border-radius: 50px;
        font-size: 0.9rem;
        color: var(--neon-blue);
        margin-bottom: 2rem;
        opacity: 0;
        animation: statusSlide 1s ease-out 1s forwards;
      }

      @keyframes statusSlide {
        to {
          opacity: 1;
        }
      }

      .status-dot {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background: radial-gradient(circle, #00d4ff 0%, #0099cc 100%);
        animation: statusPulse 3s infinite;
      }

      @keyframes statusPulse {
        0%,
        100% {
          transform: scale(1);
          box-shadow: 0 0 0 0 rgba(0, 212, 255, 0.5);
        }
        50% {
          transform: scale(1.1);
          box-shadow: 0 0 0 8px rgba(0, 212, 255, 0);
        }
      }

      /* Optimized prediction card */
      .prediction-card {
        background: var(--card-bg);
        backdrop-filter: blur(15px);
        border: 1px solid var(--border-color);
        border-radius: 25px;
        padding: 3rem;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.6);
        max-width: 800px;
        margin: 0 auto;
        position: relative;
        opacity: 0;
        transform: translateY(30px);
        animation: cardReveal 1s ease-out 1.5s forwards;
      }

      @keyframes cardReveal {
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Simplified border animation */
      .prediction-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        border-radius: 25px;
        padding: 2px;
        background: linear-gradient(
          135deg,
          rgba(0, 212, 255, 0.3) 0%,
          rgba(183, 148, 246, 0.3) 50%,
          rgba(255, 107, 157, 0.3) 100%
        );
        mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
        mask-composite: subtract;
        animation: borderFlow 6s linear infinite;
        pointer-events: none;
      }

      @keyframes borderFlow {
        0% {
          background-position: 0% 50%;
        }
        100% {
          background-position: 200% 50%;
        }
      }

      /* Form sections */
      .form-section {
        margin-bottom: 2rem;
      }

      .section-title {
        font-size: 1.4rem;
        font-weight: 700;
        color: var(--neon-blue);
        margin-bottom: 1.5rem;
        text-align: center;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .form-group {
        margin-bottom: 1.5rem;
        opacity: 0;
        animation: formSlide 0.6s ease-out forwards;
      }

      .form-group:nth-child(1) {
        animation-delay: 2s;
      }
      .form-group:nth-child(2) {
        animation-delay: 2.1s;
      }
      .form-group:nth-child(3) {
        animation-delay: 2.2s;
      }
      .form-group:nth-child(4) {
        animation-delay: 2.3s;
      }
      .form-group:nth-child(5) {
        animation-delay: 2.4s;
      }
      .form-group:nth-child(6) {
        animation-delay: 2.5s;
      }
      .form-group:nth-child(7) {
        animation-delay: 2.6s;
      }

      @keyframes formSlide {
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      .form-label {
        font-weight: 600;
        color: var(--text-primary);
        margin-bottom: 0.8rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.95rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .form-label i {
        color: var(--neon-blue);
        font-size: 1.1rem;
      }

      .form-control,
      .form-select {
        background: rgba(0, 0, 0, 0.6);
        border: 2px solid rgba(255, 255, 255, 0.1);
        color: var(--text-primary);
        border-radius: 15px;
        padding: 1rem 1.2rem;
        font-size: 1rem;
        transition: all 0.3s ease;
        backdrop-filter: blur(10px);
      }

      .form-control:focus,
      .form-select:focus {
        background: rgba(0, 0, 0, 0.8);
        border-color: var(--neon-blue);
        box-shadow: 0 0 0 3px rgba(0, 212, 255, 0.15);
        color: var(--text-primary);
        outline: none;
        transform: translateY(-2px);
      }

      .form-control::placeholder {
        color: var(--text-muted);
      }

      /* Optimized predict button */
      .btn-predict {
        background: linear-gradient(
          135deg,
          #00d4ff 0%,
          #b794f6 50%,
          #ff6b9d 100%
        );
        border: none;
        color: white;
        padding: 1.2rem 2.5rem;
        font-size: 1.2rem;
        font-weight: 700;
        border-radius: 20px;
        cursor: pointer;
        width: 100%;
        text-transform: uppercase;
        letter-spacing: 1px;
        position: relative;
        overflow: hidden;
        opacity: 0;
        transform: translateY(20px);
        animation: buttonReveal 0.8s ease-out 2.7s forwards;
        transition: all 0.3s ease;
      }

      @keyframes buttonReveal {
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .btn-predict:hover {
        transform: translateY(-3px);
        box-shadow: 0 15px 30px -5px rgba(0, 212, 255, 0.4);
      }

      .loading-spinner {
        display: none;
        margin-right: 15px;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      /* Simplified result card */
      .result-card {
        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        color: white;
        padding: 2.5rem;
        border-radius: 25px;
        text-align: center;
        margin-top: 2.5rem;
        box-shadow: 0 20px 40px -10px rgba(79, 172, 254, 0.4);
        opacity: 0;
        transform: scale(0.9);
        animation: resultReveal 0.8s ease-out forwards;
      }

      @keyframes resultReveal {
        to {
          opacity: 1;
          transform: scale(1);
        }
      }

      .predicted-price {
        font-size: 3rem;
        font-weight: 800;
        margin-bottom: 0.5rem;
        animation: priceCount 1.5s ease-out;
        font-family: "JetBrains Mono", monospace;
      }

      @keyframes priceCount {
        from {
          transform: scale(0);
          opacity: 0;
        }
        50% {
          transform: scale(1.1);
          opacity: 0.7;
        }
        to {
          transform: scale(1);
          opacity: 1;
        }
      }

      .prediction-details {
        background: rgba(255, 255, 255, 0.15);
        padding: 1.5rem;
        border-radius: 15px;
        backdrop-filter: blur(15px);
        margin-top: 1rem;
      }

      .detail-row {
        display: flex;
        justify-content: space-between;
        margin-bottom: 0.5rem;
        font-size: 0.95rem;
        padding: 0.3rem 0;
      }

      .detail-row:hover {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 8px;
        padding: 0.5rem 0.8rem;
        transition: all 0.2s ease;
      }

      /* Simplified alert */
      .alert {
        border: none;
        border-radius: 15px;
        padding: 1.2rem;
        margin-bottom: 1.5rem;
        font-weight: 500;
        opacity: 0;
        transform: translateX(-50px);
        animation: alertSlide 0.5s ease-out forwards;
      }

      @keyframes alertSlide {
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      .alert-danger {
        background: rgba(220, 38, 38, 0.1);
        border: 1px solid rgba(220, 38, 38, 0.3);
        color: #f87171;
      }

      /* Minimal particles - only 5 instead of 25 */
      .particles {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: -1;
      }

      .particle {
        position: absolute;
        width: 2px;
        height: 2px;
        background: rgba(0, 212, 255, 0.4);
        border-radius: 50%;
        animation: float 20s infinite linear;
      }

      @keyframes float {
        0% {
          transform: translateY(100vh);
          opacity: 0;
        }
        10%,
        90% {
          opacity: 1;
        }
        100% {
          transform: translateY(-100vh);
          opacity: 0;
        }
      }

      @media (max-width: 768px) {
        .hero-title {
          font-size: 2.5rem;
        }
        .prediction-card {
          margin: 0 1rem;
          padding: 2rem;
        }
        .predicted-price {
          font-size: 2.5rem;
        }
      }
    </style>
  </head>

  <body>
    <!-- Reduced car background -->
    <div class="car-background">
      <div class="car-silhouette"><i class="fas fa-car"></i></div>
      <div class="car-silhouette"><i class="fas fa-car-side"></i></div>
    </div>

    <!-- Minimal particles -->
    <div class="particles" id="particles"></div>

    <!-- Grid overlay -->
    <div class="grid-overlay"></div>

    <div class="main-container">
      <div class="container">
        <!-- Hero Section -->
        <div class="hero-section">
          <div class="hero-container">
            <h1 class="hero-title">
              <i class="fas fa-car-side"></i>
              Car Price Predictor
            </h1>
            <p class="hero-subtitle">
              Get accurate car valuations powered by advanced machine learning
              algorithms
            </p>

            {% if model_status %}
            <div class="status-indicator">
              <span class="status-dot"></span>
              AI Model Active & Ready
            </div>
            {% endif %}
          </div>
        </div>

        <!-- Main Prediction Form -->
        <div class="prediction-card">
          <form id="predictionForm">
            <!-- Vehicle Information -->
            <div class="form-section">
              <h3 class="section-title">
                <i class="fas fa-info-circle"></i> Vehicle Information
              </h3>

              <div class="form-group">
                <label for="company" class="form-label">
                  <i class="fas fa-industry"></i> Company Name
                </label>
                <select
                  class="form-select"
                  id="company"
                  name="company"
                  required
                >
                  <option value="">Select Car Brand</option>
                  {% for brand in brands %}
                  <option value="{{ brand }}">{{ brand }}</option>
                  {% endfor %}
                </select>
              </div>
            </div>

            <!-- Engine Specifications -->
            <div class="form-section">
              <h3 class="section-title">
                <i class="fas fa-cogs"></i> Engine Specifications
              </h3>

              <div class="row">
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="cc_battery_capacity" class="form-label">
                      <i class="fas fa-tachometer-alt"></i> CC/Battery Capacity
                    </label>
                    <input
                      type="number"
                      class="form-control"
                      id="cc_battery_capacity"
                      name="cc_battery_capacity"
                      min="500"
                      max="10000"
                      placeholder="e.g., 2000"
                      required
                    />
                  </div>
                </div>

                <div class="col-md-6">
                  <div class="form-group">
                    <label for="horsepower" class="form-label">
                      <i class="fas fa-horse-head"></i> HorsePower
                    </label>
                    <input
                      type="number"
                      class="form-control"
                      id="horsepower"
                      name="horsepower"
                      min="50"
                      max="2000"
                      placeholder="e.g., 150"
                      required
                    />
                  </div>
                </div>
              </div>

              <div class="row">
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="torque" class="form-label">
                      <i class="fas fa-wrench"></i> Torque (Nm)
                    </label>
                    <input
                      type="number"
                      class="form-control"
                      id="torque"
                      name="torque"
                      min="50"
                      max="2000"
                      placeholder="e.g., 200"
                      required
                    />
                  </div>
                </div>

                <div class="col-md-6">
                  <div class="form-group">
                    <label for="seats" class="form-label">
                      <i class="fas fa-chair"></i> Seats
                    </label>
                    <select
                      class="form-select"
                      id="seats"
                      name="seats"
                      required
                    >
                      <option value="">Select Seats</option>
                      <option value="2">2 Seater</option>
                      <option value="4">4 Seater</option>
                      <option value="5">5 Seater</option>
                      <option value="7">7 Seater</option>
                      <option value="8">8 Seater</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>

            <!-- Performance Metrics -->
            <div class="form-section">
              <h3 class="section-title">
                <i class="fas fa-speedometer"></i> Performance Metrics
              </h3>

              <div class="row">
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="total_speed" class="form-label">
                      <i class="fas fa-gauge-high"></i> Total Speed (km/h)
                    </label>
                    <input
                      type="number"
                      class="form-control"
                      id="total_speed"
                      name="total_speed"
                      min="100"
                      max="500"
                      placeholder="e.g., 200"
                      required
                    />
                  </div>
                </div>

                <div class="col-md-6">
                  <div class="form-group">
                    <label for="performance" class="form-label">
                      <i class="fas fa-stopwatch"></i> Performance(0-100)KM/H
                      (seconds)
                    </label>
                    <input
                      type="number"
                      class="form-control"
                      id="performance"
                      name="performance"
                      min="2"
                      max="20"
                      step="0.1"
                      placeholder="e.g., 8.5"
                      required
                    />
                  </div>
                </div>
              </div>
            </div>

            <button type="submit" class="btn-predict" id="predictBtn">
              <span class="loading-spinner">
                <i class="fas fa-spinner fa-spin"></i>
              </span>
              <span class="btn-text">
                <i class="fas fa-magic"></i> Predict Price
              </span>
            </button>
          </form>

          <!-- Results Section -->
          <div id="results" style="display: none"></div>

          <!-- Error Messages -->
          <div id="errorMessages"></div>
        </div>
      </div>
    </div>

    <!-- JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>

    <script>
      // Create minimal particles (only 5)
      function createParticles() {
        const particlesContainer = document.getElementById("particles");
        const particleCount = 5; // Reduced from 25

        for (let i = 0; i < particleCount; i++) {
          const particle = document.createElement("div");
          particle.className = "particle";
          particle.style.left = Math.random() * 100 + "%";
          particle.style.animationDelay = Math.random() * 20 + "s";
          particle.style.animationDuration = Math.random() * 10 + 20 + "s";
          particlesContainer.appendChild(particle);
        }
      }

      class CarPricePredictor {
        constructor() {
          this.form = document.getElementById("predictionForm");
          this.predictBtn = document.getElementById("predictBtn");
          this.results = document.getElementById("results");
          this.errorMessages = document.getElementById("errorMessages");
          this.loadingSpinner = document.querySelector(".loading-spinner");
          this.btnText = document.querySelector(".btn-text");

          this.init();
        }

        init() {
          this.form.addEventListener("submit", (e) => this.handleSubmit(e));
          this.addInputValidation();
        }

        addInputValidation() {
          const inputs = this.form.querySelectorAll("input, select");
          inputs.forEach((input) => {
            input.addEventListener("input", () => this.validateInput(input));
            input.addEventListener("focus", () => this.addFocusEffect(input));
            input.addEventListener("blur", () => this.removeFocusEffect(input));
          });
        }

        addFocusEffect(input) {
          input.style.transform = "translateY(-2px)";
        }

        removeFocusEffect(input) {
          if (!input.matches(":focus")) {
            input.style.transform = "";
          }
        }

        validateInput(input) {
          const isValid = input.checkValidity();
          input.classList.toggle("is-invalid", !isValid);
          input.classList.toggle(
            "is-valid",
            isValid && input.value.trim() !== ""
          );
        }

        async handleSubmit(e) {
          e.preventDefault();

          this.clearMessages();

          if (!this.validateForm()) {
            return;
          }

          this.setLoadingState(true);

          try {
            const formData = new FormData(this.form);
            const data = Object.fromEntries(formData.entries());

            const response = await fetch("/predict", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify(data),
            });

            const result = await response.json();

            if (result.success) {
              this.showResults(result);
            } else {
              this.showError(
                result.error || "An error occurred during prediction"
              );
            }
          } catch (error) {
            this.showError(
              "Network error. Please check your connection and try again."
            );
            console.error("Prediction error:", error);
          } finally {
            this.setLoadingState(false);
          }
        }

        validateForm() {
          const inputs = this.form.querySelectorAll(
            "input[required], select[required]"
          );
          let isValid = true;

          inputs.forEach((input) => {
            if (!input.value.trim()) {
              this.validateInput(input);
              isValid = false;
            }
          });

          if (!isValid) {
            this.showError("Please fill in all required fields");
          }

          return isValid;
        }

        setLoadingState(loading) {
          this.predictBtn.disabled = loading;
          this.loadingSpinner.style.display = loading ? "inline-block" : "none";
          this.btnText.innerHTML = loading
            ? '<i class="fas fa-cog fa-spin"></i> Analyzing...'
            : '<i class="fas fa-magic"></i> Predict Price';
        }

        showResults(result) {
          const {
            predicted_price,
            formatted_price,
            input_data,
            prediction_id,
          } = result;

          this.results.innerHTML = `
                    <div class="result-card">
                        <div class="predicted-price">${formatted_price}</div>
                        <div class="prediction-label">Estimated Market Value</div>
                        <div class="prediction-details">
                            <div class="detail-row">
                                <span><strong>Brand:</strong></span>
                                <span>${input_data.company}</span>
                            </div>
                            <div class="detail-row">
                                <span><strong>Engine:</strong></span>
                                <span>${input_data.cc_battery_capacity} CC, ${input_data.horsepower} HP</span>
                            </div>
                            <div class="detail-row">
                                <span><strong>Performance:</strong></span>
                                <span>${input_data.total_speed} km/h, 0-100 in ${input_data.performance}s</span>
                            </div>
                            <div class="detail-row">
                                <span><strong>Configuration:</strong></span>
                                <span>${input_data.seats} seats, ${input_data.torque} Nm torque</span>
                            </div>
                            <div class="detail-row">
                                <span><strong>Prediction ID:</strong></span>
                                <span>${prediction_id}</span>
                            </div>
                        </div>
                    </div>
                `;

          this.results.style.display = "block";

          setTimeout(() => {
            this.results.scrollIntoView({
              behavior: "smooth",
              block: "center",
            });
          }, 300);
        }

        showError(message) {
          this.errorMessages.innerHTML = `
                    <div class="alert alert-danger">
                        <i class="fas fa-exclamation-triangle"></i>
                        ${message}
                    </div>
                `;
        }

        clearMessages() {
          this.errorMessages.innerHTML = "";
          this.results.style.display = "none";
        }
      }

      // Initialize application
      document.addEventListener("DOMContentLoaded", () => {
        createParticles();
        new CarPricePredictor();
      });
    </script>
  </body>
</html>

